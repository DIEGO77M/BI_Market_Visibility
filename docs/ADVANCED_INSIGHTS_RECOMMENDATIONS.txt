INSIGHTS AVANZADOS PARA MARKET VISIBILITY - BI PROJECT
=====================================================================

Basado en an√°lisis de capas Silver y Gold
Autor: An√°lisis Data Analyst Expert
Fecha: 2026-01-06

=====================================================================

üéØ INSIGHTS AVANZADOS DE ALTO IMPACTO

=====================================================================

INSIGHT 1: PRICE ELASTICITY BY CHANNEL
---------------------------------------
Nombre: Elasticidad de Precio por Canal

Pregunta de Negocio: 
"¬øC√≥mo afectan los cambios de precio a las ventas en cada canal? 
¬øD√≥nde puedo ser m√°s agresivo con descuentos?"

C√°lculo:
Price_Elasticity = 
  % Change in Quantity Sold / % Change in Price

Espec√≠ficamente:
  ((Current_Qty - Previous_Qty) / Previous_Qty) / 
  ((Current_Price - Previous_Price) / Previous_Price)

Usando tablas existentes:
- FROM: gold_fact_sell_in (quantity_sell_in)
- JOIN: gold_fact_price_audit (observed_price)
- GROUP BY: channel, brand, year_month
- WINDOW: LAG() para per√≠odo anterior

Impacto: 
Optimizar estrategia de pricing por canal (Modern Trade vs Traditional 
Trade tiene diferente sensibilidad)

=====================================================================

INSIGHT 2: PERFECT STORE SCORE
-------------------------------
Nombre: √çndice de Tienda Perfecta

Pregunta de Negocio: 
"¬øQu√© PDVs cumplen con todos los est√°ndares de excelencia operativa 
y cu√°les necesitan intervenci√≥n urgente?"

C√°lculo:
Perfect_Store_Score = (
  (Availability_Rate √ó 0.30) +           -- Tiene stock
  (Price_Index_Compliance √ó 0.25) +      -- Precio en rango 95-105
  (Stock_Health_Days √ó 0.25) +           -- 7-30 d√≠as stock
  (Sell_Through_Rate √ó 0.20)             -- Rotaci√≥n saludable
) √ó 100

Donde:
- Availability_Rate: FROM gold_fact_stock (is_healthy_stock)
- Price_Index_Compliance: FROM gold_fact_price_audit (price_index BETWEEN 95 AND 105)
- Stock_Health_Days: FROM gold_fact_stock (stock_days BETWEEN 7 AND 30)
- Sell_Through_Rate: FROM gold_fact_sell_in / gold_fact_stock (velocity)

GROUP BY: pdv_sk, date_sk

Impacto: 
Identificar PDVs top performers vs problematic, priorizar visitas 
de merchandisers

=====================================================================

INSIGHT 3: STOCK-OUT FREQUENCY & PATTERN
-----------------------------------------
Nombre: Patr√≥n de Quiebres de Stock

Pregunta de Negocio: 
"¬øQu√© productos tienen quiebres recurrentes? ¬øHay patrones temporales 
(d√≠a de semana, fin de mes)?"

C√°lculo:
Stock_Out_Frequency = 
  COUNT(DISTINCT date_sk WHERE stock_out_flag = TRUE) /
  COUNT(DISTINCT date_sk) √ó 100

Stock_Out_Clustering_Index =
  CASE 
    WHEN consecutive_stock_out_days >= 3 THEN 'CHRONIC'
    WHEN stock_outs_last_30_days >= 5 THEN 'FREQUENT'
    WHEN stock_outs_last_30_days BETWEEN 1 AND 4 THEN 'OCCASIONAL'
    ELSE 'HEALTHY'
  END

FROM: gold_fact_stock
GROUP BY: product_sk, pdv_sk
JOIN: gold_dim_date (day_of_week, is_month_end)

Impacto: 
Detectar problemas sist√©micos de supply chain vs issues puntuales

=====================================================================

INSIGHT 4: CHANNEL CANNIBALIZATION INDEX
-----------------------------------------
Nombre: √çndice de Canibalizaci√≥n entre Canales

Pregunta de Negocio: 
"¬øEst√° el crecimiento de un canal (ej: e-commerce) robando ventas 
de otro canal (ej: retail tradicional) o expandiendo el mercado?"

C√°lculo:
Cannibalization_Index = 
  (Channel_A_Growth_Rate + Channel_B_Growth_Rate) /
  (Total_Brand_Growth_Rate)

Si > 1.0: Expansi√≥n de mercado (ambos crecen)
Si = 1.0: Suma cero (uno crece, otro decrece proporcionalmente)
Si < 1.0: Contracci√≥n (p√©rdida neta)

FROM: gold_kpi_market_share
SELECT: 
  - monthly_sell_in_qty POR channel
  - LAG() para crecimiento MoM
GROUP BY: brand, year_month

Impacto: 
Entender si estrategia omnicanal est√° funcionando o causando conflictos

=====================================================================

INSIGHT 5: LOST SALES ROOT CAUSE ANALYSIS
------------------------------------------
Nombre: An√°lisis de Causa Ra√≠z de Ventas Perdidas

Pregunta de Negocio: 
"¬øCu√°nto estoy perdiendo por stock-out vs pricing incorrecto vs 
baja rotaci√≥n?"

C√°lculo:
Lost_Sales_by_Root_Cause:

1. Stock_Out_Loss = 
   pdv_with_stock_out √ó avg_daily_demand √ó avg_unit_price √ó days_out_of_stock
   FROM: gold_fact_stock + gold_kpi_market_visibility_daily

2. Price_Premium_Loss = 
   (pdv_above_market √ó avg_demand) √ó 
   (1 - (1 / (1 + Price_Elasticity √ó (Price_Index - 100)/100)))
   FROM: gold_fact_price_audit + Elasticity calculado

3. Slow_Moving_Loss = 
   (closing_stock WHERE stock_days > 60) √ó holding_cost_rate √ó unit_price
   FROM: gold_fact_stock

Total_Recoverable_Revenue = SUM(1, 2, 3)

Impacto: 
Priorizar acciones (resolver stock-outs rinde m√°s que ajustar precios?)

=====================================================================

INSIGHT 6: GEOGRAPHIC PENETRATION OPPORTUNITY SCORE
----------------------------------------------------
Nombre: Score de Oportunidad Geogr√°fica

Pregunta de Negocio: 
"¬øEn qu√© regiones/ciudades tengo mayor potencial de crecimiento 
no explotado?"

C√°lculo:
Geographic_Opportunity_Score = 
  (Total_PDVs_in_Region - Active_PDVs_with_Product) √ó 
  Avg_Sales_Per_PDV_in_Region √ó 
  Region_Market_Share_Gap

Donde:
- Total_PDVs_in_Region: FROM gold_dim_pdv (GROUP BY region)
- Active_PDVs_with_Product: FROM gold_fact_sell_in (COUNT DISTINCT pdv_sk BY region)
- Avg_Sales_Per_PDV: FROM gold_kpi_market_visibility_daily
- Market_Share_Gap: FROM gold_kpi_market_share (portfolio_share vs target)

GROUP BY: region, brand, category
ORDER BY: Opportunity_Score DESC

Impacto: 
Guiar expansi√≥n geogr√°fica y asignaci√≥n de recursos de ventas

=====================================================================

INSIGHT 7: PRICE WAR ALERT INDEX
---------------------------------
Nombre: √çndice de Alerta de Guerra de Precios

Pregunta de Negocio: 
"¬øHay una guerra de precios en curso? ¬øCu√°ndo y d√≥nde empez√≥?"

C√°lculo:
Price_War_Index = 
  (Price_Volatility_30d √ó 0.4) +
  (Price_Drop_Velocity √ó 0.3) +
  (Market_Price_Dispersion √ó 0.3)

Donde:
Price_Volatility_30d = STDDEV(price_index) OVER (PARTITION BY product_sk ORDER BY date_sk ROWS BETWEEN 29 PRECEDING AND CURRENT ROW)

Price_Drop_Velocity = 
  (Current_Price - Price_30_days_ago) / Price_30_days_ago / 30 √ó 100

Market_Price_Dispersion = 
  (MAX(observed_price) - MIN(observed_price)) / AVG(observed_price) √ó 100

FROM: gold_fact_price_audit
GROUP BY: product_sk, category, date_sk
HAVING: Price_War_Index > 50 (threshold)

Impacto: 
Detectar temprano competencia agresiva y responder estrat√©gicamente

=====================================================================

INSIGHT 8: PRODUCT LIFECYCLE STAGE CLASSIFIER
----------------------------------------------
Nombre: Clasificador de Etapa de Ciclo de Vida

Pregunta de Negocio: 
"¬øQu√© productos est√°n en introducci√≥n, crecimiento, madurez o declive?"

C√°lculo:
Lifecycle_Stage = 
  CASE
    WHEN (MoM_Growth > 20% AND PDV_Penetration < 30%) THEN 'INTRODUCTION'
    WHEN (MoM_Growth > 10% AND PDV_Penetration BETWEEN 30 AND 70%) THEN 'GROWTH'
    WHEN (MoM_Growth BETWEEN -5% AND 5% AND PDV_Penetration > 70%) THEN 'MATURITY'
    WHEN (MoM_Growth < -5%) THEN 'DECLINE'
  END

MoM_Growth = 
  (Current_Month_Qty - Previous_Month_Qty) / Previous_Month_Qty √ó 100

PDV_Penetration = 
  COUNT(DISTINCT pdv_sk with product) / 
  COUNT(DISTINCT pdv_sk total) √ó 100

FROM: gold_kpi_market_share + gold_fact_sell_in
GROUP BY: product_sk, year_month

Impacto: 
Ajustar inversi√≥n en marketing/trade por producto (no invertir igual 
en todos)

=====================================================================

INSIGHT 9: CHANNEL PROFITABILITY INDEX (ESTIMATED)
---------------------------------------------------
Nombre: √çndice de Rentabilidad por Canal

Pregunta de Negocio: 
"¬øQu√© canales generan m√°s valor neto despu√©s de considerar costos 
operativos?"

C√°lculo:
Channel_Profitability_Index = 
  (Total_Revenue √ó Gross_Margin) - 
  (Lost_Sales + Stock_Holding_Cost + Price_Discount_Cost) /
  Total_Revenue √ó 100

Donde:
- Total_Revenue: FROM gold_fact_sell_in (SUM value_sell_in)
- Lost_Sales: FROM gold_kpi_market_visibility_daily (lost_sales_value_estimated)
- Stock_Holding_Cost: FROM gold_fact_stock (closing_stock √ó holding_rate)
- Price_Discount_Cost: FROM gold_fact_price_audit (below_market_value_lost)

GROUP BY: channel, brand, year_month

Impacto: 
Identificar canales con alto volumen pero baja rentabilidad real

=====================================================================

INSIGHT 10: PREDICTIVE STOCK-OUT RISK SCORE
--------------------------------------------
Nombre: Score Predictivo de Riesgo de Quiebre

Pregunta de Negocio: 
"¬øQu√© productos tendr√°n stock-out en los pr√≥ximos 7 d√≠as si no hay 
reposici√≥n?"

C√°lculo:
Stock_Out_Risk_Score = 
  CASE
    WHEN (stock_days < 7 AND sell_through_acceleration > 1.2) THEN 'HIGH'
    WHEN (stock_days < 14 AND sell_through_rate > avg) THEN 'MEDIUM'
    WHEN (stock_days >= 14) THEN 'LOW'
  END

sell_through_acceleration = 
  avg_daily_sell_out_last_7_days / 
  avg_daily_sell_out_last_30_days

Days_Until_Stock_Out_Predicted = 
  closing_stock / 
  (avg_daily_sell_out_last_7_days √ó sell_through_acceleration)

FROM: gold_fact_stock + gold_fact_sell_in
GROUP BY: product_sk, pdv_sk, date_sk

Impacto: 
Alertas proactivas para reponer antes del quiebre (no reactivas)

=====================================================================

üéñÔ∏è TOP 3 INSIGHTS CON MAYOR IMPACTO INMEDIATO

1. PERFECT STORE SCORE ‚Üí Priorizaci√≥n operativa clara
2. LOST SALES ROOT CAUSE ANALYSIS ‚Üí Cuantificar recuperaci√≥n de revenue
3. PREDICTIVE STOCK-OUT RISK ‚Üí Prevenir vs reaccionar

=====================================================================

üìä IMPLEMENTACI√ìN SUGERIDA

Todos estos insights se pueden calcular usando:
- Tablas Gold existentes (fact_sell_in, fact_price_audit, fact_stock)
- KPIs actuales (market_visibility_daily, market_share)
- Funciones Window de Spark SQL (LAG, LEAD, STDDEV, etc.)
- Sin necesidad de datos externos (todo viene de las capas Silver/Gold)

=====================================================================

VENTAJAS CLAVE:
‚úì Implementables con infraestructura actual
‚úì No requieren nuevas fuentes de datos
‚úì Aprovechan arquitectura Medallion existente
‚úì Calculables en capa Gold con Spark SQL
‚úì Listos para consumo en Power BI / Streamlit

=====================================================================
FIN DEL DOCUMENTO
=====================================================================